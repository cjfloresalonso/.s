# sweep scan
qm () {
        nmap -vv --privileged \
                -T4 -Pn --randomize-hosts \
                -sSV -O \
                $( [ -v NMAP_DNS_SERVERS ] && echo "--dns-servers=$NMAP_DNS_SERVERS" ) \
                -oA $(mktemp -qd quick.XXXXX)/scan \
                $@
}

# sweep scan
sm () {
        nmap -vv --privileged \
                -sn \
                $( [ -v NMAP_DNS_SERVERS ] && echo "--dns-servers=$NMAP_DNS_SERVERS" ) \
                -oA $(mktemp -qd sweep.XXXXX)/scan \
                $@
}

# host scan
hm () {
        nmap -vv --privileged \
                -T4 -Pn --randomize-hosts \
                -sS -A -p- \
                --script-args http.useragent=${NMAP_USER_AGENT:-'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0'} \
                $( [ -v NMAP_DNS_SERVERS ] && echo "--dns-servers=$NMAP_DNS_SERVERS" ) \
                -oA $(mktemp -qd host.XXXXX)/scan \
                $@
}

# full host map
fm () {
        nmap -vv --privileged \
                -T4 -Pn --randomize-hosts \
                -sS -A -p- \
                --version-all --osscan-guess \
                --script='(auth or discovery or exploit or vuln) and not (dos or external or *ipv6*)' \
                --script-args http.useragent=${NMAP_USER_AGENT:-'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0'} \
                $( [ -v NMAP_DNS_SERVERS ] && echo "--dns-servers=$NMAP_DNS_SERVERS" ) \
                -oA $(mktemp -qd full.XXXXX)/scan \
                $@
}

# udp host map
um () {
        nmap -vv --privileged \
                -T4 -Pn --randomize-hosts \
                -sU -A -p- \
                --version-all --osscan-guess \
                --script='(auth or discovery or exploit or vuln) and not (dos or external or *ipv6*)' \
                --script-args http.useragent=${NMAP_USER_AGENT:-'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0'} \
                $( [ -v NMAP_DNS_SERVERS ] && echo "--dns-servers=$NMAP_DNS_SERVERS" ) \
                -oA $(mktemp -qd udp.XXXXX)/scan \
                $@
}

# connect map
cm () {
        nmap -vv --privileged \
                -T4 -Pn --randomize-hosts \
                -sT -A -p- \
                --version-all --osscan-guess \
                --script='(auth or discovery or exploit or vuln) and not (dos or external or *ipv6*)' \
                --script-args http.useragent=${NMAP_USER_AGENT:-'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0'} \
                $( [ -v NMAP_DNS_SERVERS ] && echo "--dns-servers=$NMAP_DNS_SERVERS" ) \
                -oA $(mktemp -qd connect.XXXXX)/scan \
                $@
}
